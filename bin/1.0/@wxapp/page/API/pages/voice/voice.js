"use strict";var util=require("../../../../util/util.js"),playTimeInterval=void 0,recordTimeInterval=void 0;Page({onShareAppMessage:function(){return{title:"录音",path:"page/API/pages/voice/voice"}},data:{recording:!1,playing:!1,hasRecord:!1,recordTime:0,playTime:0,formatedRecordTime:"00:00:00",formatedPlayTime:"00:00:00"},onHide:function(){this.data.playing?this.stopVoice():this.data.recording&&this.stopRecordUnexpectedly()},startRecord:function(){this.setData({recording:!0});var t=this;recordTimeInterval=setInterval(function(){var e=t.data.recordTime+=1;t.setData({formatedRecordTime:util.formatTime(t.data.recordTime),recordTime:e})},1e3),wx.startRecord({success:function(e){t.setData({hasRecord:!0,tempFilePath:e.tempFilePath,formatedPlayTime:util.formatTime(t.data.playTime)})},complete:function(){t.setData({recording:!1}),clearInterval(recordTimeInterval)}})},stopRecord:function(){wx.stopRecord()},stopRecordUnexpectedly:function(){var e=this;wx.stopRecord({success:function(){console.log("stop record success"),clearInterval(recordTimeInterval),e.setData({recording:!1,hasRecord:!1,recordTime:0,formatedRecordTime:util.formatTime(0)})}})},playVoice:function(){var t=this;playTimeInterval=setInterval(function(){var e=t.data.playTime+1;console.log("update playTime",e),t.setData({playing:!0,formatedPlayTime:util.formatTime(e),playTime:e})},1e3),wx.playVoice({filePath:this.data.tempFilePath,success:function(){clearInterval(playTimeInterval);console.log("play voice finished"),t.setData({playing:!1,formatedPlayTime:util.formatTime(0),playTime:0})}})},pauseVoice:function(){clearInterval(playTimeInterval),wx.pauseVoice(),this.setData({playing:!1})},stopVoice:function(){clearInterval(playTimeInterval),this.setData({playing:!1,formatedPlayTime:util.formatTime(0),playTime:0}),wx.stopVoice()},clear:function(){clearInterval(playTimeInterval),wx.stopVoice(),this.setData({playing:!1,hasRecord:!1,tempFilePath:"",formatedRecordTime:util.formatTime(0),recordTime:0,playTime:0})}});